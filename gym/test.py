import matplotlib.pyplot as plt
import numpy as np
import math, json

from analyse import plot_compare, validate_reward
import analyse
import benchdata

def analyse_test(isshow=True):
    result, ep_r = benchdata.exp4_benchmark_data()
    
    result, ep_r = benchdata.success_1_data()

    result, ep_r = benchdata.success_2_data()

    result, ep_r = [571506264.0, 449619440.0, 296206120.0, 325220704.0, 439127712.0, 368714632.0, 403816168.0, 361447576.0, 324930304.0, 376384928.0, 352647296.0, 379154776.0, 312493736.0, 345608832.0, 526690080.0, 431116328.0, 415757936.0, 378331720.0, 331336704.0, 379197280.0, 347899192.0, 331736184.0, 332143432.0, 328755552.0, 417516296.0, 386786696.0, 332468944.0, 364173480.0, 364416952.0, 335601080.0, 489429416.0, 391252080.0, 345115208.0, 406067424.0, 422584904.0, 366058584.0, 354135280.0, 318889128.0, 380839432.0, 460260232.0, 317004800.0, 366221064.0, 355093520.0, 303769272.0, 327082352.0, 322358560.0, 400251848.0, 337961032.0, 337833728.0, 405982400.0, 404056304.0, 343633864.0, 337451992.0, 371133680.0, 355409296.0, 468056808.0, 307985376.0, 349257224.0, 286828744.0, 364533296.0, 368657776.0, 322574448.0, 386211776.0, 360255464.0, 443173968.0, 330634208.0, 414368392.0, 385563344.0, 355275408.0, 408944336.0, 333311976.0, 355945104.0, 314030832.0, 367516016.0, 320283224.0, 343852256.0, 323938624.0, 336965816.0, 374889336.0, 364671392.0, 429028800.0, 351567672.0, 347552008.0, 346851144.0, 311628576.0, 412641720.0, 393715264.0, 416794584.0, 444265760.0, 448980856.0, 418086440.0, 375572680.0, 449252768.0, 389128384.0, 388999360.0, 300489744.0, 405047400.0, 381330520.0, 356738952.0, 318322440.0, 335356680.0, 385036208.0, 495206232.0, 430572520.0, 364066088.0, 346961008.0, 330984544.0, 390921680.0, 326801256.0, 349837352.0, 525329800.0, 310715816.0, 386962056.0, 394910592.0, 361864840.0, 388686512.0, 355994288.0, 320322712.0, 485691184.0, 381603296.0, 370634104.0, 379572296.0, 319310824.0, 308216312.0, 472053552.0, 320458304.0, 301072040.0, 362616720.0, 376653200.0, 316047432.0, 336332296.0, 359840760.0, 349530360.0, 315148920.0, 335741560.0, 342327744.0, 300880432.0, 309590832.0, 327234624.0, 322871776.0, 373146240.0, 345350096.0, 324736560.0, 423233328.0, 348177152.0, 395117888.0, 309436536.0, 305013016.0, 333714976.0, 329675520.0, 350794960.0, 334506856.0, 361270848.0, 342133472.0, 343320872.0, 383898008.0, 344425176.0, 328391368.0, 346593032.0, 374233200.0, 363746536.0, 383049328.0, 408064856.0, 437827416.0, 333356984.0, 479221624.0, 354986120.0, 348350320.0, 328767472.0, 342929480.0, 426873048.0, 392806584.0, 305598936.0, 311333592.0, 388011448.0, 317360664.0, 316952640.0, 334224184.0, 368883704.0, 356938336.0, 416695264.0, 363730272.0, 338732144.0, 389205448.0, 312811880.0, 331536816.0, 325576528.0, 334286912.0, 320549744.0, 316341264.0, 361908160.0, 397221712.0, 391095776.0, 298458976.0, 340525608.0, 382275712.0, 407849240.0, 404245696.0, 365466648.0, 313191248.0, 319055288.0, 312553320.0, 338012064.0, 392000240.0, 366553216.0, 321246216.0, 368013728.0, 434165856.0, 452565792.0, 331241576.0, 369548608.0, 338794856.0, 370781208.0, 380631704.0, 329771616.0, 337168312.0, 399173000.0, 413666136.0, 446491536.0, 382984496.0, 340565272.0, 425005776.0, 338634344.0, 367436864.0, 343167544.0, 352137376.0, 369611344.0, 423770160.0, 378539224.0, 397210584.0, 451899840.0, 397168376.0, 422019976.0, 376801800.0, 438981176.0, 396109224.0, 471338968.0, 391353976.0, 430724160.0, 371072648.0, 389128888.0, 316826728.0, 382586272.0, 359349496.0, 339801912.0, 366770200.0, 385932744.0, 388349920.0, 337297072.0, 307308568.0, 401727432.0, 317440392.0, 358491552.0, 306142576.0, 315146784.0, 372754288.0, 367681296.0, 373922600.0, 439396272.0, 495729472.0, 402024432.0, 384353840.0, 355859864.0, 351808432.0, 345206536.0, 352460136.0, 353775696.0, 397314944.0, 341338904.0, 384184560.0, 359733312.0, 404091080.0, 382289408.0, 435949936.0, 444797160.0, 386306456.0, 314919456.0, 323521176.0, 317253928.0, 373638848.0, 375401288.0, 346809712.0, 401985672.0, 377567320.0, 364570944.0, 368291704.0, 330241672.0, 347008720.0, 348259832.0, 335455016.0, 311898928.0, 400075496.0, 373722760.0, 364748152.0, 337275840.0, 395335224.0, 501848680.0, 462442728.0, 463424840.0, 409673200.0, 437994112.0, 401822864.0, 398652752.0, 358084696.0, 371615072.0, 417536736.0, 423553616.0, 373480168.0, 371067816.0, 399753544.0, 366467688.0, 385912592.0, 356893720.0, 359869568.0, 394887400.0, 401623104.0, 410260544.0, 422364088.0, 381922336.0, 387159640.0, 474924808.0, 411040296.0, 385892344.0, 428903280.0, 536044048.0, 533351936.0, 445946024.0, 376591080.0, 471016592.0, 469074448.0, 513882648.0, 454441608.0, 483279208.0, 462685600.0, 411542280.0, 421957688.0, 409741976.0, 470939080.0, 469804704.0, 402320632.0, 406444352.0, 447153688.0, 467213936.0, 432140984.0, 405610072.0, 521597328.0, 660121840.0, 458159272.0, 427568960.0, 503914136.0, 386107192.0, 357521168.0, 415649480.0, 399773960.0, 458858200.0, 482861112.0, 520312536.0, 506450424.0, 372012560.0, 351255352.0, 473123408.0, 378699920.0, 386856408.0, 378805784.0, 379048640.0, 430928456.0, 422473816.0, 322382872.0, 370972544.0, 380229824.0, 410307136.0, 416789440.0, 455783888.0, 465319064.0, 368570576.0, 457812784.0, 376172808.0, 384478832.0, 402856008.0, 348916024.0, 390225072.0, 462798328.0, 349114944.0, 415211432.0, 519059400.0, 439281752.0, 357842752.0, 387764640.0, 527731368.0, 461612512.0, 582014272.0, 574262872.0] , [-3656053.429006982, -2777232.6071823416, -1835114.56803332, -2028606.3087327399, -3121883.54099201, -2153609.8087103907, -2551925.450439031, -2489106.296411418, -1994447.7913384105, -2568896.0979976966, -1787326.4558090752, -2068944.7785705635, -1920361.5784944722, -1987776.899415321, -3333981.925742249, -2840652.2706922414, -2519541.568377759, -2455432.0847879127, -2177855.2629025998, -2222947.6457812665, -2072114.1272502164, -2164182.160689657, -1903962.6660033583, -1828489.1122206019, -3119294.9906108896, -2297762.3866694705, -2049784.3379948216, -2222107.355872118, -2163215.885674102, -2220754.933862668, -4131998.184856664, -2377398.0976038645, -2082544.9690163962, -2425182.0804939247, -2760170.373161305, -2276967.3047994035, -1935961.3787579774, -1894294.9741663018, -2487710.3747361377, -4078176.09402741, -1799636.3443920594, -2191637.1101559694, -2111443.7059393697, -1878128.4717396412, -2110736.704761836, -1754768.3344822691, -2589770.2354445807, -1896055.7374041558, -1975911.5642902874, -2612449.9864811986, -2498166.0753945885, -2330404.4587844526, -1837052.4414052716, -2127537.0117146075, -2510099.3313169614, -3173862.461670623, -1803628.8862023675, -2045630.367236147, -1715169.2192463437, -2292351.742386399, -2152452.8487367914, -1914376.0166679632, -2816728.796681016, -1934392.7136956067, -2801451.2750149164, -1900238.276876598, -2954997.883952475, -2415620.4171159086, -2283093.135558766, -2492999.414536928, -1973645.1463313487, -2113957.835208713, -1640754.0907258934, -2239058.0333489105, -1878045.132432077, -2066407.876795316, -1825579.7593597511, -2046664.2936432133, -2299457.3331132564, -2182638.147219555, -2834266.673595828, -2172011.091894459, -2013167.6105089753, -1979767.288673831, -1839689.4550801453, -2718609.1865457664, -2635167.9056364284, -2657820.7360776016, -2815990.5949155143, -3110823.22065561, -3094450.786944934, -1982246.032028646, -2798555.9477912034, -2438379.0705862525, -2842071.6291447952, -1699540.2415690667, -2975579.0764032803, -2333538.4279774916, -2322965.6730846413, -2125278.9419730394, -2028326.1257448667, -2422897.2664857414, -2952231.2694228142, -2503705.175593028, -2333722.3717991807, -2000089.6460138427, -1990526.2532000907, -2264340.3085241253, -1927961.314056067, -2194507.0523420773, -3966674.2430860414, -1879992.7986403313, -2392014.185323002, -2408863.8657509624, -2318948.358616451, -2476164.522542582, -2427762.11353254, -1999011.77934338, -3148669.9138087085, -2423544.9553882177, -2433609.7055370915, -2403851.8504718444, -1894706.151847569, -1756425.4202531914, -2920541.058517762, -1995290.8842699593, -1673045.6116050824, -2158122.671167956, -2750787.7401327402, -1889961.1952604232, -1967798.8114461044, -2097068.5682810468, -1983179.0954255275, -1867647.6059591058, -2119917.5765815675, -1962624.746526604, -1833078.0131650579, -1951068.9470730287, -1925336.3906265667, -1900827.3390730694, -2242667.152349469, -2362059.3027532496, -2074489.8321780998, -3108715.144050655, -2067976.3742371865, -2650628.3258241187, -1750737.4712898615, -1884010.3281904093, -1969552.3368742515, -2069709.366134652, -2221819.810463651, -1976150.7227164225, -2037777.9271111542, -2099401.838056594, -2044044.824370776, -2311863.1467609773, -2036426.2835286364, -2149579.6636506207, -2031773.3336237126, -2312880.773927062, -2278953.72923225, -2452964.274301471, -2440542.529734035, -2637065.268610858, -1699878.703034377, -3190319.1932334146, -2074602.6956636931, -2275725.3447088003, -1865785.71671221, -2010395.1809260685, -2634205.084250201, -2964279.1457737037, -1883150.5432771079, -1788269.5086939044, -2638557.249469865, -1734193.8050664016, -1909048.3225286081, -1928765.446500907, -2271588.918187256, -2070171.5612202508, -2543635.8061930127, -2124541.3575957604, -1980738.1004313114, -2307449.7136771814, -1733500.784563682, -2014199.8091370703, -1878728.3745920185, -2036529.5896924983, -1881709.9388710866, -1732723.4092612376, -2130858.0602066014, -2353211.6281587374, -2275911.933053222, -1753224.652997092, -2196445.4547398365, -2575333.0004778253, -2481238.9075438925, -2539483.7516414253, -2113110.27580239, -1872302.6113665544, -1848296.4906604341, -1914427.6777799968, -2047727.6955815116, -2226456.472343181, -2145291.859424782, -1941293.0423655147, -2278311.191746862, -2719473.196005428, -3000853.6532907947, -2015320.562663469, -2374626.021156867, -2033203.3007660406, -2133579.061117332, -2471032.7780243056, -2117410.0845039757, -2047135.2527810459, -2593354.766140738, -2627867.9874139586, -3038743.623662839, -2724897.9740431663, -2059776.662783854, -2799687.6222612993, -2170656.553544788, -2637862.1178337648, -2201350.1097495793, -2281647.6268188963, -2252611.047298564, -2863315.2336336947, -2501818.0841053464, -2614901.73333988, -2808777.573594115, -2669508.3291242486, -2655216.0118877497, -2180410.2866380312, -2898099.147009304, -2726107.0157432966, -2936587.1629333897, -2530590.6715578134, -2734128.1313052084, -2148903.8433174086, -2485451.6527321837, -1883707.0162041648, -2687094.170692596, -2458533.639133557, -2017457.2504116488, -2269297.751890175, -2359417.110830859, -2835030.7777829, -2152056.427668905, -1793755.430487065, -3054567.0198797276, -2012470.0808168645, -2186282.0592951346, -1801404.9558674546, -1829521.3578318364, -2299929.0048551336, -2198432.2660036935, -2292205.562424489, -2803274.3370735557, -3619292.6449557804, -2721939.637038842, -2313579.031155223, -2444371.483623976, -2033968.1369689682, -1936589.1779694504, -2074419.1168653206, -2244322.351317609, -2656569.637433346, -1968621.275665546, -2432554.194865197, -2392980.6919735665, -2735416.943814136, -2481361.180620141, -3154145.9422078645, -3452072.7839522446, -2949139.0554852905, -1835821.6508838674, -1805440.9636735234, -1784980.3454980648, -2277220.9691406786, -2228796.440023736, -2091393.4645165005, -2659045.499576741, -2786946.79334921, -2151692.6309840586, -2247016.587163216, -2182436.5210164576, -2020173.6898671358, -1884838.633620631, -2112647.458184948, -1872687.9800533068, -2464026.1320214765, -2250100.4834826477, -2171005.580291266, -2058626.2020012657, -2842472.211424777, -3327333.2676530066, -2978676.0601827917, -3124120.573339414, -2587716.497605168, -2810854.763932784, -2407159.3738704775, -2807610.6329435403, -2359439.4794645114, -2189803.3252533264, -2681638.702625112, -2676371.5658303066, -2549205.6538198446, -2399573.2226915294, -2473547.065951649, -2365101.0464817127, -2399363.5116513465, -2097398.542449019, -2268612.5339743034, -2626454.5788638177, -2410507.213993672, -2741021.0553059364, -2500359.0680255466, -2406776.74552526, -2337712.0127853537, -3410438.677062282, -2449360.9664795524, -2337174.6281651375, -2582072.9642373594, -3122972.007118502, -3602332.3043005434, -3131480.6810232247, -2215504.668923449, -3023393.966330657, -2825882.8981360947, -3096542.4434665246, -2743372.317011003, -2954738.1358221075, -2662790.9240847486, -2405850.297690779, -2638752.955847491, -2277839.011914662, -2948156.4990137783, -3204652.554106585, -2253682.756138228, -2480787.4498998043, -2575329.3952441267, -2559354.683442024, -2908693.3507125485, -2495289.8897223435, -2891643.1241926025, -3945486.998065113, -2951805.8022884866, -3360674.2336067334, -3220934.475808376, -2434017.6595367226, -2172988.1480050203, -2531843.150419348, -2390177.6640114337, -2636951.47577386, -2721287.8172224076, -3184175.1670480017, -2561661.3238580716, -2034722.1210258068, -2405119.8879681854, -4074037.6016363767, -2281102.755482789, -2412987.42810929, -2435841.5707628527, -2364971.353979923, -2709715.182511788, -2497758.426027274, -1885476.522091051, -2157039.1177496733, -1932573.106301901, -2513439.3133174796, -2805591.3037709147, -2935314.4274712675, -2714785.2349581677, -2267158.376420533, -2723319.4407177074, -2271167.9087282764, -2309404.8960384373, -2460267.895327084, -2198152.2160976874, -2276152.451915404, -3101361.157565774, -2069347.8776355414, -2577217.231524983, -3182752.512149641, -2833104.7173047704, -2031371.0387120303, -2183219.937332199, -2878659.3009453006, -3001960.122591714, -3382825.96248373, -3326035.284056086]




    print("Number of samples:", len(result))
    if isshow:
        # validate_reward(result, ep_r)
        isbench = False
        plot_compare(result, ep_r, is_benchmark=isbench) 

        analyse.plot_smoothing(range(len(result)), result, "result")
        analyse.add_compare(is_benchmark=isbench)

        analyse.plot_smoothing(range(len(ep_r)), ep_r, "ep_reward")

        plt.show()
    return result, ep_r

def sentsize_analyse():
    sentsize = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9505.322576459963, 9505.322576459963, 9505.322576459963, 9505.322576459963, 19010.645152919926, 19010.645152919926, 28515.96772937989, 28515.96772937989, 28661.755146833602, 28661.755146833602, 2144678.6128822947, 2144678.6128822947, 212297436.5738683, 212297436.5738683, 249561087.99993956, 249561087.99993956, 873463808.0017198, 873463808.0017198, 2507852532.4736414, 2706374655.996888, 4005023538.072938, 5368709120.034672, 6710886399.989506, 10737418240.141117, 16106127360.678226, 16106127360.678226, 36238786561.117645, 37855922813.222496, 38923141117.14698, 53687091196.00705, 60796008569.466286, 61740154873.32862, 62416486394.990814, 80629110423.08272, 86501409005.08333, 189246996580.90283, 201325543535.78384, 248480452086.99997, 378493992788.34814, 379029815122.59106, 440411802591.9665, 542775442729.77856, 560867572972.6469, 560867572972.6469, 560867572972.6469, 562209750248.1156, 563551927523.5844, 566220766643.5763, 568905121194.5138, 570617545482.0778, 571959722757.5465, 573301900033.0153, 617868388128.9595, 680652700504.4099, 680772949619.5264, 680772949619.5264, 680935969258.2792, 680935969258.2792, 680935969258.2792, 690858665559.2069, 740315648897.62, 788778573266.4092, 790751341149.9325, 807973582760.5133, 834280283683.317, 847702677817.0414, 864773753127.4205, 890949572246.5964, 899030474835.654, 899370756569.9557, 904391501589.0104, 915296352220.1692, 923946361869.0674, 933044429245.2684, 936002142163.029, 941217290743.3174, 951757255783.5919, 958884457569.5787, 962111064558.1997, 967592827362.4146, 968909984819.0391, 974160607557.1099, 976250727027.0239, 976838351552.1116, 978198789742.8928, 991014677057.1802, 994240463485.446, 1000153905368.5172, 1017532963201.1436, 1023131617622.6857, 1029559360933.5713, 1030898837533.4852, 1041623726711.451, 1047138426550.6992, 1053672929642.272, 1058527975668.549, 1061747704269.0442, 1065005730529.8082, 1068162164992.4022, 1070854833027.1404, 1070975911490.2434, 1072398059649.215, 1073740236924.6837, 1075082414200.1525, 1076424591475.6212, 1108425327521.5815, 1140029139228.5269, 1151486053655.6414, 1165668969818.3845, 1216929235520.7595, 1270165051638.059, 1287614552544.1755, 1304851856251.1409, 1358039763763.5469, 1408147242556.953, 1410800904279.1597, 1437359657099.1953, 1476756342730.352, 1514514190011.3652, 1530979193095.6555, 1544984952679.6702, 1576379788394.9624, 1605861555096.7932, 1627144138598.8313, 1629474692037.265, 1651724352927.8772, 1673793997682.2668, 1692560653900.5237, 1705626870541.019, 1710847783197.7285, 1717654785406.3252, 1728011237197.24, 1735016593148.0442, 1741727479640.2317, 1747207425911.941, 1751233957807.2534, 1754782425578.5107, 1757365800330.298, 1793002082247.9612, 1856267147843.2883, 1906688073338.0195, 1956609757124.968, 1991899697802.1936, 2017378902901.0076, 2040660917642.3506, 2053340104802.1208, 2069228826619.596, 2082382932303.3765, 2089347905481.298, 2096090577294.029, 2100050455818.0315, 2102497167829.9338, 2104190689000.9358, 2105532866299.3733, 2106606732117.5535]

    sentsize = [e for e in sentsize if e != 0]
    import seaborn as sns 
    sns.distplot(np.log10(sentsize))
    plt.show()

def smooth_plot():
    x = np.arange(10)
    y = (x**2)
    res, _ = analyse_test()
    y = np.array(res)/1e7
    # print(y)

    DIR = "tf_log/test"
    import os 
    os
    import tensorflow as tf 
    a = tf.placeholder(dtype=tf.float32, shape=[])
    tf.summary.scalar("a", a)
    merged = tf.summary.merge_all()
    init = tf.global_variables_initializer()
    with tf.Session() as sess:
        summary = sess.run(init)
        writer = tf.summary.FileWriter(DIR, sess.graph)
        for i in range(y.shape[0]):
            s = sess.run(merged, feed_dict={a:y[i]})
            writer.add_summary(s, i)
    
def f():
    pass
    with open("doc/log/success-2/data.json", "w") as f:
        json.dump(analyse.parse_complete_log("doc/log/success-2/log/log_10.txt"), f)

if __name__ == "__main__":
    pass
    analyse_test()
    # sentsize_analyse()
    # f()
    # smooth_plot()